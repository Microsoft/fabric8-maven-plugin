[[fabric8secrets]]
== *fabric8:secrets*


WARNING: This goal support to creat docker registry secrets only now.

This goal is for creating link:[kubernetes secrets] yaml file for your
Maven project in a security way.

For creating a secrets yaml file you simply call `fabric8:secrets` goal
on command line:

[source,bash]
----
mvn fabric8:secrets
----

Configure docker registry secrets as section
link:#authentication[Authentication] says, save the server information
into `~/.m2/setting.xml`.

[[xml-configuration]]
=== XML configuration


Refer docker id in the `pom.xml`. It should contain the following field:

[width="11%",cols="34%,33%,33%",options="header",]
|=======================================================================
|key |required |description
|dockerId |true |the server id which is configured in
`~/.m2/setting.xml`

|name |true |this will be used as name of the kubernetes secret resource

|namespace |false |the secret resource will be apply to the specific
namespace, default is `default`
|=======================================================================

This is best explained by an example.

_Example for XML configuration_

[source,xml]
----
<properties>
    <docker.registry>docker.io</docker.registry>
</properties>
...
<configuration>
    <resources>
        <secrets>
            <secret>
                <dockerId>${docker.registry}</dockerId>
                <name>mydockerkey</name>
            </secret>
        </secrets>
    </resources>
</configuration>
----

[[yaml-fragment-with-annotation]]
=== Yaml fragment with annotation


Refer the docker id in a yaml fragment with an annotaion
`maven.fabric8.io/dockerId`. The yaml fragment file should be put under
the `src/fabric8/secrets` folder.

_Example_

[source,yaml]
----
apiVersion: v1
kind: Secret
metadata:
  name: mydockerkey
  namespace: default
  annotations:
    maven.fabric8.io/dockerId: ${docker.registry}
type: kubernetes.io/dockercfg
----